<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018.3 (Released July 19, 2018) -->
<HTML lang="EN">
<HEAD>
<TITLE>Optimizers</TITLE>
<META NAME="description" CONTENT="Optimizers">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.3">

<LINK REL="STYLESHEET" HREF="manual.css">
<LINK REL="STYLESHEET" HREF="pygments.css">

<LINK REL="previous" HREF="node489.html">
<LINK REL="next" HREF="node491.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node491.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node488.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node489.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html4315"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html4317"
  HREF="node513.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node491.html">Equations used in the</A>
<B> Up:</B> <A
 HREF="node488.html">Optimization of the objective</A>
<B> Previous:</B> <A
 HREF="node489.html">Function</A>
 &nbsp; <B>  <A ID="tex2html4316"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html4318"
  HREF="node513.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A ID="CHILD_LINKS"><STRONG>Subsections</STRONG></A>

<UL CLASS="ChildLinks">
<LI><A ID="tex2html4319"
  HREF="node490.html#SECTION001322100000000000000">Molecular dynamics</A>
<LI><A ID="tex2html4320"
  HREF="node490.html#SECTION001322200000000000000">Langevin dynamics</A>
<LI><A ID="tex2html4321"
  HREF="node490.html#SECTION001322300000000000000">Self-guided MD and LD</A>
<LI><A ID="tex2html4322"
  HREF="node490.html#SECTION001322400000000000000">Rigid bodies</A>
<LI><A ID="tex2html4323"
  HREF="node490.html#SECTION001322500000000000000">Rigid molecular dynamics</A>
<LI><A ID="tex2html4324"
  HREF="node490.html#SECTION001322600000000000000">Rigid minimization</A>
</UL>
<!--End of Table of Child-Links-->
<HR>

<H2><A ID="SECTION001322000000000000000">
Optimizers</A>
</H2>

<P>
M<SMALL>ODELLER</SMALL> currently implements a Beale restart conjugate gradients 
algorithm [<A
 HREF="node512.html#ShaPhu80">Shanno &amp; Phua, 1980</A>,<A
 HREF="node512.html#ACM500">Shanno &amp; Phua, 1982</A>] and a molecular dynamics procedure with the
leap-frog Verlet integrator [<A
 HREF="node512.html#Ver67">Verlet, 1967</A>].
The conjugate gradients optimizer is usually
used in combination with the variable target function method 
[<A
 HREF="node512.html#BraGo85">Braun &amp; G&#245;, 1985</A>] which is
implemented with the <TT>automodel</TT> class (Section&nbsp;<A HREF="node494.html#SECTION:flowchart">A.4</A>). 
The molecular
dynamics procedure can be used in a simulated annealing protocol that
is also implemented with the <TT>automodel</TT> class.

<P>

<H3><A ID="SECTION001322100000000000000">
Molecular dynamics</A>
</H3>

<P>
Force in M<SMALL>ODELLER</SMALL> is obtained by equating the objective function <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img188.png"
 ALT="$F$"></SPAN>
with internal energy in kcal/mole. The atomic masses are all set to
that of C<SPAN CLASS="MATH"><sup>12</sup></SPAN> (M<SMALL>ODELLER</SMALL> unit is kg/mole). The initial velocities
at a given temperature are obtained from a Gaussian random number
generator with a mean and standard deviation of:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
\bar{v}_x & = & 0 \\
\sigma_x  & = & \sqrt{\frac{k_B T}{m_i}}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 1.82ex; vertical-align: -0.46ex; " SRC="img201.png"
 ALT="$\displaystyle \bar{v}_x$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%">0</TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">7</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img203.png"
 ALT="$\displaystyle \sigma_x$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.06ex; " SRC="img204.png"
 ALT="$\displaystyle \sqrt{\frac{k_B T}{m_i}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">8</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <SPAN CLASS="MATH"><IMG STYLE="height: 1.96ex; vertical-align: -0.46ex; " SRC="img205.png"
 ALT="$k_B$"></SPAN> is the Boltzmann constant, <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img206.png"
 ALT="$m_i$"></SPAN> is the mass of one C<SPAN CLASS="MATH"><sup>12</sup></SPAN> atom,
and the velocity is expressed in angstroms/femtosecond.

<P>
The Newtonian equations of motion are integrated by the leap-frog Verlet
algorithm [<A
 HREF="node512.html#Ver67">Verlet, 1967</A>]:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A ID="eq:verlet"></A><!-- MATH
 \begin{eqnarray}
\dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) & = & \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) - \frac{\partial F}{\partial \vec{r}_i(t)}\frac{\delta t}{m_i} \\
\vec{r}_i\left(t+\delta t\right) & = & \vec{r}_i(t) + \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right)\delta t
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 5.60ex; vertical-align: -2.32ex; " SRC="img207.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.32ex; " SRC="img208.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) - \frac{\partial F}{\partial \vec{r}_i(t)}\frac{\delta t}{m_i}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">9</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.38ex; vertical-align: -0.70ex; " SRC="img209.png"
 ALT="$\displaystyle \vec{r}_i\left(t+\delta t\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.60ex; vertical-align: -2.32ex; " SRC="img210.png"
 ALT="$\displaystyle \vec{r}_i(t) + \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right)\delta t$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">10</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img211.png"
 ALT="$\vec{r}_i$"></SPAN> is the position of atom <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img60.png"
 ALT="$i$"></SPAN>. In addition, velocity is
capped at a maximum value, before calculating the shift, such that the
maximal shift along one axis can only be <I CLASS="sans">cap_atom_shift</I><A NAME="43561"></A>. The
velocities can be equilibrated every <I CLASS="sans">equilibrate</I><A NAME="43564"></A> steps to
stabilize temperature.  This is achieved by scaling the velocities
with a factor <SPAN CLASS="MATH"><IMG STYLE="height: 2.17ex; vertical-align: -0.57ex; " SRC="img74.png"
 ALT="$f$"></SPAN>:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
f       & = & \sqrt{T/T_{kin}} \\
T_{kin} & = & \frac{E_{kin}}{\frac{1}{2} k_{b} N_{f}} \\
E_{kin} & = & \frac{1}{2} \sum_i^{N_{atoms}} m_i\dot{\vec{r}}_i^2
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.17ex; vertical-align: -0.57ex; " SRC="img212.png"
 ALT="$\displaystyle f$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 2.87ex; vertical-align: -0.71ex; " SRC="img213.png"
 ALT="$\displaystyle \sqrt{T/T_{kin}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">11</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img214.png"
 ALT="$\displaystyle T_{kin}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.62ex; " SRC="img215.png"
 ALT="$\displaystyle \frac{E_{kin}}{\frac{1}{2} k_{b} N_{f}}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">12</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img216.png"
 ALT="$\displaystyle E_{kin}$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 6.85ex; vertical-align: -3.09ex; " SRC="img217.png"
 ALT="$\displaystyle \frac{1}{2} \sum_i^{N_{atoms}} m_i\dot{\vec{r}}_i^2$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">13</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <SPAN CLASS="MATH"><IMG STYLE="height: 1.96ex; vertical-align: -0.46ex; " SRC="img205.png"
 ALT="$k_B$"></SPAN> is the Boltzmann constant, <SPAN CLASS="MATH"><IMG STYLE="height: 2.31ex; vertical-align: -0.78ex; " SRC="img218.png"
 ALT="$N_f$"></SPAN> the number of degrees of freedom,
<SPAN CLASS="MATH"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img219.png"
 ALT="$E_{kin}$"></SPAN> the current kinetic energy and <SPAN CLASS="MATH"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img220.png"
 ALT="$T_{kin}$"></SPAN> the current kinetic
temperature.

<P>

<H3><A ID="SECTION001322200000000000000">
Langevin dynamics</A>
</H3>

<P>
Langevin dynamics (LD) are implemented as in [<A
 HREF="node512.html#LonBroPas92">Loncharich <EM>et&nbsp;al.</EM>, 1992</A>]. The equations
of motion (Equation&nbsp;<A HREF="#eq:verlet">A.9</A>) are modified as follows:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A ID="eq:langevin"></A><!-- MATH
 \begin{equation}
\dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) = \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) \frac{1-\frac{1}{2}\gamma\delta t}{1+\frac{1}{2}\gamma\delta t} + \left(\vec{R}_i - \frac{\partial F}{\partial \vec{r}_i(t)}\right) \frac{\delta t}{m_i} \frac{1}{1+\frac{1}{2}\gamma\delta t}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 6.22ex; vertical-align: -2.62ex; " SRC="img221.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) = \dot{\vec{r}}_...
...\vec{r}_i(t)}\right) \frac{\delta t}{m_i} \frac{1}{1+\frac{1}{2}\gamma\delta t}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">14</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <SPAN CLASS="MATH"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img104.png"
 ALT="$\gamma$"></SPAN> is a friction factor (in <SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.57ex; " SRC="img222.png"
 ALT="$fs^{-1}$"></SPAN>) and <SPAN CLASS="MATH"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img223.png"
 ALT="$\vec{R}_i$"></SPAN> a random
force, chosen to have zero mean and standard deviation
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\sigma(\vec{R}_i) = \sqrt{\frac{2\gamma m_i k_{B} T}{\delta t}}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.67ex; vertical-align: -1.89ex; " SRC="img224.png"
 ALT="$\displaystyle \sigma(\vec{R}_i) = \sqrt{\frac{2\gamma m_i k_{B} T}{\delta t}}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">15</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>

<H3><A ID="SECTION001322300000000000000">
Self-guided MD and LD</A>
</H3>

<P>
M<SMALL>ODELLER</SMALL> also implements the self-guided MD [<A
 HREF="node512.html#Wu99">Wu &amp; Wang, 1999</A>] and LD [<A
 HREF="node512.html#Wu03">Wu &amp; Brooks, 2003</A>]
methods. For self-guided MD, the equations of motion (Equation&nbsp;<A HREF="#eq:verlet">A.9</A>)
are modified as follows:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A ID="eq:sgmd"></A><!-- MATH
 \begin{eqnarray}
\vec{g}_i(t) & = & \left(1 - \frac{\delta t}{t_l}\right) \vec{g}_i(t - \delta t) + \frac{\delta t}{t_l}\left(\lambda \vec{g}_i(t-\delta t) - \frac{\partial F}{\partial \vec{r}_i(t)}\right) \\
\dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) & = & \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) + \left(\lambda \vec{g}_i(t) - \frac{\partial F}{\partial \vec{r}_i(t)}\right)\frac{\delta t}{m_i}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.38ex; vertical-align: -0.70ex; " SRC="img225.png"
 ALT="$\displaystyle \vec{g}_i(t)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.32ex; " SRC="img226.png"
 ALT="$\displaystyle \left(1 - \frac{\delta t}{t_l}\right) \vec{g}_i(t - \delta t) + \...
...\lambda \vec{g}_i(t-\delta t) - \frac{\partial F}{\partial \vec{r}_i(t)}\right)$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">16</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 5.60ex; vertical-align: -2.32ex; " SRC="img207.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.32ex; " SRC="img227.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) + \left(\lambda \vec{g}_i(t) - \frac{\partial F}{\partial \vec{r}_i(t)}\right)\frac{\delta t}{m_i}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">17</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

where <SPAN CLASS="MATH"><IMG STYLE="height: 1.68ex; vertical-align: -0.12ex; " SRC="img228.png"
 ALT="$\lambda$"></SPAN> is the guiding factor (the same for all atoms), <SPAN CLASS="MATH"><IMG STYLE="height: 1.89ex; vertical-align: -0.46ex; " SRC="img229.png"
 ALT="$t_l$"></SPAN> the guide
time in femtoseconds, and <SPAN CLASS="MATH"><IMG STYLE="height: 1.68ex; vertical-align: -0.68ex; " SRC="img230.png"
 ALT="$\vec{g}_i$"></SPAN> a guiding force, set to zero at the
start of the simulation. (Position <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img211.png"
 ALT="$\vec{r}_i$"></SPAN> is updated in the usual way.)

<P>
For self-guided Langevin dynamics, the guiding forces are determined as follows
(terms are as defined in Equation&nbsp;<A HREF="#eq:langevin">A.14</A>):
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\vec{g}_i(t) = \left(1 - \frac{\delta t}{t_l}\right) \vec{g}_i(t - \delta t) + \frac{\delta t}{t_l}\gamma m_i \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.60ex; vertical-align: -2.32ex; " SRC="img231.png"
 ALT="$\displaystyle \vec{g}_i(t) = \left(1 - \frac{\delta t}{t_l}\right) \vec{g}_i(t ...
...\frac{\delta t}{t_l}\gamma m_i \dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">18</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
A scaling parameter <SPAN CLASS="MATH">&chi;</SPAN> is then determined by first making an unconstrained
half step:
<BR>
<DIV ALIGN="CENTER" CLASS="mathdisplay">
<!-- MATH
 \begin{eqnarray}
\dot{\vec{r}}_i'(t) & = & \dot{\vec{r}}_i\left(t - \frac{\delta t}{2}\right) + \frac{1}{2}\left(\lambda \vec{g}_i(t) + \vec{R}_i - \frac{\delta F}{\delta \vec{r}_i(t)}\right) \frac{\delta t}{m_i} \\
\zeta & = & \left(1+\frac{\gamma\delta t}{2}\right)\frac{\sum_i^N \lambda \vec{g}_i(t)\dot{\vec{r}}_i'(t)}{\sum_i^N m_i \dot{\vec{r}}_i'^2(t)} \\
\chi & = & \left(1 + \frac{(\gamma + \zeta)\delta t}{2}\right)^{-1}
\end{eqnarray}
 -->
<TABLE CELLPADDING="0" ALIGN="CENTER" WIDTH="100%">
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.52ex; vertical-align: -0.70ex; " SRC="img233.png"
 ALT="$\displaystyle \dot{\vec{r}}_i'(t)$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 5.67ex; vertical-align: -2.32ex; " SRC="img234.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t - \frac{\delta t}{2}\right) + \frac{1}{2}\...
... + \vec{R}_i - \frac{\delta F}{\delta \vec{r}_i(t)}\right) \frac{\delta t}{m_i}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">19</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 2.10ex; vertical-align: -0.57ex; " SRC="img235.png"
 ALT="$\displaystyle \zeta$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 6.64ex; vertical-align: -2.84ex; " SRC="img236.png"
 ALT="$\displaystyle \left(1+\frac{\gamma\delta t}{2}\right)\frac{\sum_i^N \lambda \vec{g}_i(t)\dot{\vec{r}}_i'(t)}{\sum_i^N m_i \dot{\vec{r}}_i'^2(t)}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">20</SPAN>)</TD></TR>
<TR VALIGN="MIDDLE"><TD NOWRAP WIDTH="50%" ALIGN="RIGHT"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img237.png"
 ALT="$\displaystyle \chi$"></TD>
<TD WIDTH="10" ALIGN="CENTER" NOWRAP><IMG STYLE="height: 0.63ex; vertical-align: -0.12ex; " SRC="img202.png"
 ALT="$\displaystyle =$"></TD>
<TD ALIGN="LEFT" NOWRAP WIDTH="50%"><IMG STYLE="height: 6.08ex; vertical-align: -2.32ex; " SRC="img238.png"
 ALT="$\displaystyle \left(1 + \frac{(\gamma + \zeta)\delta t}{2}\right)^{-1}$"></TD>
<TD CLASS="eqno" WIDTH=10 ALIGN="RIGHT">
(A.<SPAN CLASS="arabic">21</SPAN>)</TD></TR>
</TABLE></DIV>
<BR CLEAR="ALL">

<P>
Finally, the velocities are advanced using the scaling factor:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A ID="eq:sgld"></A><!-- MATH
 \begin{equation}
\dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) = (2\chi - 1)\dot{\vec{r}}_i\left(t-\frac{\delta t}{2}\right) + \left(\lambda \vec{g}_i(t) + \vec{R}_i - \frac{\partial F}{\partial \vec{r}_i(t)}\right) \frac{\delta t}{m_i}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.67ex; vertical-align: -2.32ex; " SRC="img239.png"
 ALT="$\displaystyle \dot{\vec{r}}_i\left(t+\frac{\delta t}{2}\right) = (2\chi - 1)\do...
...vec{R}_i - \frac{\partial F}{\partial \vec{r}_i(t)}\right) \frac{\delta t}{m_i}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">22</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>

<H3><A ID="SECTION001322400000000000000">
Rigid bodies</A>
</H3>

<P>
Where rigid bodies are used, these are optimized separately from the other
atoms in the system. This has the additional advantage of reducing the number
of degrees of freedom.

<P>

<H3><A ID="SECTION001322500000000000000">
Rigid molecular dynamics</A>
</H3>
The state of each rigid body is specified by the position of the center of
mass, <!-- MATH
 $\vec{r}_{COM}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img240.png"
 ALT="$\vec{r}_{COM}$"></SPAN>, and an orientation quaternion, <SPAN CLASS="MATH"><IMG STYLE="height: 2.10ex; vertical-align: -0.57ex; " SRC="img241.png"
 ALT="$\tilde{q}$"></SPAN> [<A
 HREF="node512.html#Gol80">Goldstein, 1980</A>].
(The quaternion
has 4 components, <SPAN CLASS="MATH"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img242.png"
 ALT="$q_1$"></SPAN> through <SPAN CLASS="MATH"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img243.png"
 ALT="$q_4$"></SPAN>, of which the first three refer to the
vector part, and the last to the scalar.) The translational and rotational
motions of each body are separated. Each body is translated about its center
of mass using the standard Verlet equations (Equation&nbsp;<A HREF="#eq:verlet">A.9</A>) using
the force:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><A ID="eq:forcecom"></A><!-- MATH
 \begin{equation}
\frac{\partial{F}}{\partial{\vec{r}_{COM}}} = \sum_i \frac{\partial{F}}{\partial{\vec{r_i}}}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 6.08ex; vertical-align: -3.09ex; " SRC="img244.png"
 ALT="$\displaystyle \frac{\partial{F}}{\partial{\vec{r}_{COM}}} = \sum_i \frac{\partial{F}}{\partial{\vec{r_i}}}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">23</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where the sum <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img60.png"
 ALT="$i$"></SPAN> operates over all atoms in the rigid body, and <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img245.png"
 ALT="$\vec{r_i}$"></SPAN>
is the position of atom <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img60.png"
 ALT="$i$"></SPAN> in real space.

<P>
For the rotational motion, the orientation quaternions are again integrated
using the same Verlet equations. For this, the quaternion accelerations are
calculated using the following relation [<A
 HREF="node512.html#Rapaport:97">Rapaport, 1997</A>]:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\ddot{\tilde{q}} = \frac{1}{2} \mathsfsl{W}^T\left(
\begin{array}{c}
\dot{\omega}'_x \\
\dot{\omega}'_y \\
\dot{\omega}'_z \\
-2\sum_m \dot{q}_m^2 \\
\end{array} \right)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE=""
 SRC="img246.png"
 ALT="\begin{displaymath}\ddot{\tilde{q}} = \frac{1}{2} \mathsfsl{W}^T\left(
\begin{ar...
...dot{\omega}'_z \\
-2\sum_m \dot{q}_m^2 \\
\end{array} \right)\end{displaymath}"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">24</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 $\mathsfsl{W}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img247.png"
 ALT="$\mathsfsl{W}$"></SPAN> is the orthogonal matrix
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{W} = \left(\begin{array}{rrrr}
 q_4  &  q_3  &  -q_2  &  -q_1 \\
-q_3  &  q_4  &   q_1  &  -q_2 \\
 q_2  & -q_1  &   q_4  &  -q_3 \\
 q_1  &  q_2  &   q_3  &   q_4 \\
\end{array}\right)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 11.26ex; vertical-align: -5.11ex; " SRC="img248.png"
 ALT="$\displaystyle \mathsfsl{W} = \left(\begin{array}{rrrr}
q_4 &amp; q_3 &amp; -q_2 &amp; -q_1 ...
..._2 \\
q_2 &amp; -q_1 &amp; q_4 &amp; -q_3 \\
q_1 &amp; q_2 &amp; q_3 &amp; q_4 \\
\end{array}\right)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">25</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
and <!-- MATH
 $\dot{\omega}'_k$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.45ex; vertical-align: -0.77ex; " SRC="img249.png"
 ALT="$\dot{\omega}'_k$"></SPAN> is the first derivative of the angular velocity (in the
body-fixed frame) about axis <SPAN CLASS="MATH"><IMG STYLE="height: 1.68ex; vertical-align: -0.12ex; " SRC="img166.png"
 ALT="$k$"></SPAN> - <EM>i.e.</EM>, the angular acceleration. These
angular accelerations are in turn calculated from the Euler equations for
rigid body rotation, such as:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\dot{\omega}'_x = \frac{T_x + (I_y - I_z)\omega'_y\omega'_z}{I_x}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.53ex; vertical-align: -2.06ex; " SRC="img250.png"
 ALT="$\displaystyle \dot{\omega}'_x = \frac{T_x + (I_y - I_z)\omega'_y\omega'_z}{I_x}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">26</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
(Similar equations exist for the <SPAN CLASS="MATH"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img49.png"
 ALT="$y$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.12ex; vertical-align: -0.12ex; " SRC="img50.png"
 ALT="$z$"></SPAN> components.) The angular velocities
<!-- MATH
 $\vec{\omega}'$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.82ex; vertical-align: -0.12ex; " SRC="img251.png"
 ALT="$\vec{\omega}'$"></SPAN> are obtained from the quaternion velocities:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\left(\begin{array}{c}
\omega'_x \\
\omega'_y \\
\omega'_z \\
0 \\
\end{array}\right) = 2\mathsfsl{W}\dot{\tilde{q}}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 11.26ex; vertical-align: -5.14ex; " SRC="img252.png"
 ALT="$\displaystyle \left(\begin{array}{c}
\omega'_x \\
\omega'_y \\
\omega'_z \\
0 \\
\end{array}\right) = 2\mathsfsl{W}\dot{\tilde{q}}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">27</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
The torque, <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img253.png"
 ALT="$\vec{T}$"></SPAN>, in the body-fixed frame, is calculated as
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\vec{T} = \mathsfsl{A} \sum_i (\vec{r_i} - \vec{r}_{COM}) \times -\frac{\partial{F}}{\partial{\vec{r_i}}}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 6.08ex; vertical-align: -3.09ex; " SRC="img254.png"
 ALT="$\displaystyle \vec{T} = \mathsfsl{A} \sum_i (\vec{r_i} - \vec{r}_{COM}) \times -\frac{\partial{F}}{\partial{\vec{r_i}}}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">28</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
and <!-- MATH
 $\mathsfsl{A}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img255.png"
 ALT="$\mathsfsl{A}$"></SPAN> is the rotation matrix to convert from world space to body space
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{A} = 2 \left( \begin{array}{ccc}
q_1^2 + q_4^2 - \frac{1}{2}  & q_1q_2 + q_3q_4  &  q_1q_3 - q_2q_4 \\
q_1q_2 - q_3q_4  & q_2^2 + q_4^2 - \frac{1}{2}  &  q_2q_3 + q_1q_4 \\
q_1q_3 + q_2q_4  & q_2q_3 - q_1q_4              & q_3^2 + q_4^2 - \frac{1}{2} \\
\end{array}\right)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.53ex; vertical-align: -3.73ex; " SRC="img256.png"
 ALT="$\displaystyle \mathsfsl{A} = 2 \left( \begin{array}{ccc}
q_1^2 + q_4^2 - \frac{...
...+ q_2q_4 &amp; q_2q_3 - q_1q_4 &amp; q_3^2 + q_4^2 - \frac{1}{2} \\
\end{array}\right)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">29</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
and finally the <SPAN CLASS="MATH"><IMG STYLE="height: 1.12ex; vertical-align: -0.12ex; " SRC="img48.png"
 ALT="$x$"></SPAN> component of the inertia tensor, <SPAN CLASS="MATH"><IMG STYLE="height: 2.03ex; vertical-align: -0.46ex; " SRC="img257.png"
 ALT="$I_x$"></SPAN>, is given by
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
I_x = \sum_i m_i ({r'}_{i,y}^2 + {r'}_{i,z}^2)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.25ex; vertical-align: -3.09ex; " SRC="img258.png"
 ALT="$\displaystyle I_x = \sum_i m_i ({r'}_{i,y}^2 + {r'}_{i,z}^2)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">30</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 $\vec{r'_i}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 2.59ex; vertical-align: -0.83ex; " SRC="img259.png"
 ALT="$\vec{r'_i}$"></SPAN> is the position of each atom in body space (<EM>i.e.</EM> relative to
the center of mass, and unrotated), and <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img206.png"
 ALT="$m_i$"></SPAN> is the mass of atom <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img60.png"
 ALT="$i$"></SPAN> (taken
to be the mass of one <SPAN CLASS="MATH"><IMG STYLE="height: 2.03ex; vertical-align: -0.12ex; " SRC="img260.png"
 ALT="$C^{12}$"></SPAN> atom, as above). Similar relations exist for
the <SPAN CLASS="MATH"><IMG STYLE="height: 1.54ex; vertical-align: -0.57ex; " SRC="img49.png"
 ALT="$y$"></SPAN> and <SPAN CLASS="MATH"><IMG STYLE="height: 1.12ex; vertical-align: -0.12ex; " SRC="img50.png"
 ALT="$z$"></SPAN> components.

<P>
The kinetic energy of each rigid body (used for temperature control) is given
as a combination of translation and rotational components:
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
E_{kin}^{body} = \frac{1}{2}(\sum_i m) \dot{\vec{r}}_{COM}^{2} +
                 \frac{1}{2}(I_x {\omega'}_x^2 + I_y {\omega'}_y^2 +
                             I_z {\omega'}_z^2)
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.94ex; vertical-align: -3.09ex; " SRC="img261.png"
 ALT="$\displaystyle E_{kin}^{body} = \frac{1}{2}(\sum_i m) \dot{\vec{r}}_{COM}^{2} +
\frac{1}{2}(I_x {\omega'}_x^2 + I_y {\omega'}_y^2 +
I_z {\omega'}_z^2)$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">31</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
Initial translational and rotational velocities of each rigid body are set
in the same way as for atomistic dynamics.

<P>

<H3><A ID="SECTION001322600000000000000">
Rigid minimization</A>
</H3>
The state of each rigid body is specified by 6 parameters: the position
of the center of mass, <!-- MATH
 $\vec{r}_{COM}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img240.png"
 ALT="$\vec{r}_{COM}$"></SPAN>, and the rotations in radians about
the body-fixed axes: <SPAN CLASS="MATH"><IMG STYLE="height: 2.10ex; vertical-align: -0.46ex; " SRC="img262.png"
 ALT="$\theta_x$"></SPAN>, <SPAN CLASS="MATH"><IMG STYLE="height: 2.38ex; vertical-align: -0.78ex; " SRC="img263.png"
 ALT="$\theta_y$"></SPAN>, and <SPAN CLASS="MATH"><IMG STYLE="height: 2.10ex; vertical-align: -0.46ex; " SRC="img264.png"
 ALT="$\theta_z$"></SPAN>. The first
derivative of the objective function <SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img188.png"
 ALT="$F$"></SPAN> with respect to the center of mass
is obtained from Equation&nbsp;<A HREF="#eq:forcecom">A.23</A>, and those with respect to the
angles from:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\frac{\partial{F}}{\partial{\theta_k}} = \mathsfsl{M_k}\vec{r'_i} \cdot \frac{\partial{F}}{\partial{\vec{r_i}}}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 5.25ex; vertical-align: -2.06ex; " SRC="img265.png"
 ALT="$\displaystyle \frac{\partial{F}}{\partial{\theta_k}} = \mathsfsl{M_k}\vec{r'_i} \cdot \frac{\partial{F}}{\partial{\vec{r_i}}}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">32</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
The transformation matrices <!-- MATH
 $\mathsfsl{M_k}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.96ex; vertical-align: -0.46ex; " SRC="img266.png"
 ALT="$\mathsfsl{M_k}$"></SPAN> are given as:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{M_x} = \left[ \begin{array}{ccc}
             0 & -\sin{\theta_z}\sin{\theta_x} - \cos{\theta_z}\sin{\theta_y}\cos{\theta_x} & \sin{\theta_z}\cos{\theta_x} - \cos{\theta_z}\sin{\theta_y}\sin{\theta_x} \\
             0 & -\cos{\theta_z}\sin{\theta_x} + \sin{\theta_z}\sin{\theta_y}\cos{\theta_x} & \cos{\theta_z}\cos{\theta_x} + \sin{\theta_z}\sin{\theta_y}\sin{\theta_x} \\
             0 & -\cos{\theta_y}\cos{\theta_x} & -\cos{\theta_y}\sin{\theta_x} \\
             \end{array}\right]
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.46ex; vertical-align: -3.72ex; " SRC="img267.png"
 ALT="$\displaystyle \mathsfsl{M_x} = \left[ \begin{array}{ccc}
0 &amp; -\sin{\theta_z}\si...
...{\theta_y}\cos{\theta_x} &amp; -\cos{\theta_y}\sin{\theta_x} \\
\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">33</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{M_y} = \left[ \begin{array}{ccc}
             -\cos{\theta_z}\sin{\theta_y} & -\cos{\theta_z}\cos{\theta_y}\sin{\theta_x} & \cos{\theta_z}\cos{\theta_y}\cos{\theta_x} \\
             \sin{\theta_z}\sin{\theta_y} & \sin{\theta_z}\cos{\theta_y}\sin{\theta_x} & -\sin{\theta_z}\cos{\theta_y}\cos{\theta_x} \\
             -\cos{\theta_y} & \sin{\theta_y}\sin{\theta_x} & -\sin{\theta_y}\cos{\theta_x} \\
             \end{array}\right]
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.46ex; vertical-align: -3.72ex; " SRC="img268.png"
 ALT="$\displaystyle \mathsfsl{M_y} = \left[ \begin{array}{ccc}
-\cos{\theta_z}\sin{\t...
...{\theta_y}\sin{\theta_x} &amp; -\sin{\theta_y}\cos{\theta_x} \\
\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">34</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{M_z} = \left[ \begin{array}{ccc}
             -\sin{\theta_z}\cos{\theta_y} & \cos{\theta_z}\cos{\theta_x} + \sin{\theta_z}\sin{\theta_y}\sin{\theta_x} & \cos{\theta_z}\sin{\theta_x} - \sin{\theta_z}\sin{\theta_y}\cos{\theta_x} \\
             -\cos{\theta_z}\cos{\theta_y} & -\sin{\theta_z}\cos{\theta_x} + \cos{\theta_z}\sin{\theta_y}\sin{\theta_x} & -\sin{\theta_z}\sin{\theta_x} - \cos{\theta_z}\sin{\theta_y}\cos{\theta_x} \\
             0 & 0 & 0 \\
             \end{array}\right]
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.46ex; vertical-align: -3.72ex; " SRC="img269.png"
 ALT="$\displaystyle \mathsfsl{M_z} = \left[ \begin{array}{ccc}
-\sin{\theta_z}\cos{\t...
...\cos{\theta_z}\sin{\theta_y}\cos{\theta_x} \\
0 &amp; 0 &amp; 0 \\
\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">35</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>
The atomic positions <SPAN CLASS="MATH"><IMG STYLE="height: 1.47ex; vertical-align: -0.46ex; " SRC="img245.png"
 ALT="$\vec{r_i}$"></SPAN> are reconstructed when necessary from the
body's orientation by means of the following relation:

<P>
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\vec{r_i} = \mathsfsl{M}\vec{r'_i} + \vec{r}_{COM}
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 2.73ex; vertical-align: -0.83ex; " SRC="img270.png"
 ALT="$\displaystyle \vec{r_i} = \mathsfsl{M}\vec{r'_i} + \vec{r}_{COM}$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">36</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>
where <!-- MATH
 $\mathsfsl{M}$
 -->
<SPAN CLASS="MATH"><IMG STYLE="height: 1.61ex; vertical-align: -0.12ex; " SRC="img271.png"
 ALT="$\mathsfsl{M}$"></SPAN> is the rotation matrix
<P></P>
<DIV ALIGN="CENTER" CLASS="mathdisplay"><!-- MATH
 \begin{equation}
\mathsfsl{M} = \left[ \begin{array}{ccc}
           \cos{\theta_z}\cos{\theta_y} & \sin{\theta_z}\cos{\theta_x} - \cos{\theta_z}\sin{\theta_y}\sin{\theta_x} & \sin{\theta_z}\sin{\theta_x} + \cos{\theta_z}\sin{\theta_y}\cos{\theta_x} \\
           -\sin{\theta_z}\cos{\theta_y} & \cos{\theta_z}\cos{\theta_x} + \sin{\theta_z}\sin{\theta_y}\sin{\theta_x} & \cos{\theta_z}\sin{\theta_x} - \sin{\theta_z}\sin{\theta_y}\cos{\theta_x} \\
           -\sin{\theta_y} & -\cos{\theta_y}\sin{\theta_x} & \cos{\theta_y}\cos{\theta_x} \\
             \end{array}\right]
\end{equation}
 -->
<TABLE CLASS="equation" >
<TR>
<TD  style="text-align:center;"><SPAN CLASS="MATH"><IMG STYLE="height: 8.46ex; vertical-align: -3.72ex; " SRC="img272.png"
 ALT="$\displaystyle \mathsfsl{M} = \left[ \begin{array}{ccc}
\cos{\theta_z}\cos{\thet...
...s{\theta_y}\sin{\theta_x} &amp; \cos{\theta_y}\cos{\theta_x} \\
\end{array}\right]$"></SPAN></TD>
<TD  CLASS="eqno" style="text-align:right">
(A.<SPAN CLASS="arabic">37</SPAN>)</TD></TR>
</TABLE></DIV>
<P></P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node491.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node488.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node489.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html4315"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html4317"
  HREF="node513.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node491.html">Equations used in the</A>
<B> Up:</B> <A
 HREF="node488.html">Optimization of the objective</A>
<B> Previous:</B> <A
 HREF="node489.html">Function</A>
 &nbsp; <B>  <A ID="tex2html4316"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html4318"
  HREF="node513.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
