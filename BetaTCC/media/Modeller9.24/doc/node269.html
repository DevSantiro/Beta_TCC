<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018.3 (Released July 19, 2018) -->
<HTML lang="EN">
<HEAD>
<TITLE>molecular_dynamics() &mdash; optimize atoms given restraints, with MD</TITLE>
<META NAME="description" CONTENT="molecular_dynamics() &mdash; optimize atoms given restraints, with MD">
<META NAME="keywords" CONTENT="manual">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018.3">

<LINK REL="STYLESHEET" HREF="manual.css">
<LINK REL="STYLESHEET" HREF="pygments.css">

<LINK REL="next" HREF="node270.html">
<LINK REL="previous" HREF="node268.html">
<LINK REL="next" HREF="node270.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node270.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node266.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node268.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html3181"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html3183"
  HREF="node513.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node270.html">actions.write_structure()   write</A>
<B> Up:</B> <A
 HREF="node266.html">The optimizers module: optimization</A>
<B> Previous:</B> <A
 HREF="node268.html">quasi_newton()   optimize</A>
 &nbsp; <B>  <A ID="tex2html3182"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html3184"
  HREF="node513.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION0011113000000000000000">
molecular_dynamics() &mdash; optimize atoms given restraints, with MD</A>
</H2> <A NAME="25305"></A><A ID="CMD:moleculardynamics"></A>
<A NAME="25308"></A><TT>molecular_dynamics(output='NO_REPORT', cap_atom_shift=0.2, md_time_step=4.0, init_velocities=True, temperature=293.0, md_return='FINAL', equilibrate=999999, guide_factor=0.0, guide_time=0.0, friction=0.0, residue_span_range=(0, 99999), **vars)</TT>
<BR>
<A NAME="25005"></A>
<DL>
<DT><STRONG>Output:</STRONG></DT>
<DD><I CLASS="sans">molpdf</I><A NAME="25315"></A>
                             
</DD>
</DL>

<P>
<DL>
<DT><STRONG>Requirements:</STRONG></DT>
<DD>restraints
                             
</DD>
</DL>

<P>
<BLOCKQUOTE>
This command creates a new <A ID="tex2html153"
  HREF="https://www.python.org/">Python</A> optimizer object. Calling the
object's <TT>optimize</TT> method with an atom selection then performs a molecular
dynamics optimization at a fixed temperature. This is the most basic version
of the iterative solver of the Newton's equations of motion. The integrator
uses the Verlet algorithm [<A
 HREF="node512.html#Ver67">Verlet, 1967</A>]. All atomic masses are set to that 
of carbon 12.
A brief description of the algorithm is given in
Section&nbsp;<A HREF="node488.html#SECTION:energydesc">A.2</A>.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>The molecular dynamics optimizer pretends that the natural logarithm
of the molecular pdf is energy in kcal/mole. <I CLASS="sans">md_time_step</I><A NAME="25349"></A> is the time
step in femtoseconds. <I CLASS="sans">temperature</I><A NAME="25352"></A> is the temperature of the system
in Kelvin. <I CLASS="sans">max_iterations</I><A NAME="25355"></A> determines the number of MD steps.
If <I CLASS="sans">md_return</I><A NAME="25358"></A> is <TT>'FINAL'</TT> the last structure is returned as
the MODEL. If <I CLASS="sans">md_return</I><A NAME="25362"></A> is <TT>'MINIMAL'</TT> then the structure with
the lowest value of the objective function on the whole trajectory is 
returned as the MODEL.
Rescaling of velocities is done every <I CLASS="sans">equilibrate</I><A NAME="25366"></A> steps to match
the specified temperature. Atomic shifts along one axis are limited by
<I CLASS="sans">cap_atom_shift</I><A NAME="25369"></A> (in angstroms). This value should be smaller than
<I CLASS="sans"><A HREF="node129.html#MEMB:energydata.updatedynamic">energy_data.update_dynamic</A></I><A NAME="25372"></A>. If <I CLASS="sans">init_velocities</I><A NAME="25377"></A> = <TT>True</TT>, the
velocity arrays are initialized, otherwise they are not. In that case,
the final velocities from the previous run are used as the initial
velocities for the current run.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>If both <I CLASS="sans">guide_factor</I><A NAME="25381"></A> and <I CLASS="sans">guide_time</I><A NAME="25384"></A> are non-zero, self-guided
molecular dynamics [<A
 HREF="node512.html#Wu99">Wu &amp; Wang, 1999</A>] is carried out.
</BLOCKQUOTE>
<P>
<BLOCKQUOTE>See <B><A HREF="node267.html#CMD:conjugategradients">conjugate_gradients()</A></B><A NAME="25387"></A> for a description of the other parameters
and the <I CLASS="sans">edat</I><A NAME="25392"></A> and <I CLASS="sans">actions</I><A NAME="25395"></A> optional keyword arguments.

</BLOCKQUOTE>

<P>
<B>Example:</B> See <B><A HREF="node267.html#CMD:conjugategradients">conjugate_gradients()</A></B><A NAME="25401"></A> command.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node270.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node266.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node268.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html3181"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html3183"
  HREF="node513.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node270.html">actions.write_structure()   write</A>
<B> Up:</B> <A
 HREF="node266.html">The optimizers module: optimization</A>
<B> Previous:</B> <A
 HREF="node268.html">quasi_newton()   optimize</A>
 &nbsp; <B>  <A ID="tex2html3182"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html3184"
  HREF="node513.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
